{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Force Directed Graph</title>


{#    <script src="{% static 'scripts/d3.v4.js' %}"></script>#}
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script>
        /* Here the nodes represent stations, for which we store the name, and links represent the
         fact that one can travel between the two stations. For each link we store the node index
         of the starting station and the end station. */


        function draw(data) {
            var width = 1500,
                    height = 1500;
            var svg = d3.select("body")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height);
            var node = svg.selectAll("circle.node")
                    .data(data.nodes)
                    .enter()
                    .append("circle")
                    .attr("class", "node")
                    .attr("r", 12);
            var link = svg.selectAll("line.link")
                    .data(data.links)
                    .enter().append("line")
                    .style("stroke", "black");

            // instantiate the algorithm
            var force = d3.layout.force()
                    .charge(-120)
                    .linkDistance(30)
                    .size([width, height])
                    .nodes(data.nodes)
                    .links(data.links)
                    .start();

            force.on("tick", function () {
                link.attr("x1", function (d) {
                    return d.source.x;
                })
                        .attr("y1", function (d) {
                            return d.source.y;
                        })
                        .attr("x2", function (d) {
                            return d.target.x;
                        })
                        .attr("y2", function (d) {
                            return d.target.y;
                        });
                node.attr("cx", function (d) {
                    return d.x;
                })
                        .attr("cy", function (d) {
                            return d.y;
                        });
            });

            node.call(force.drag);
        } // END of function draw(data)


    </script>

    <style>

    </style>
</head>
<body>


<script>
    d3.json("{% static 'data/stations_graph.json' %}", draw)
</script>
</body>
</html>